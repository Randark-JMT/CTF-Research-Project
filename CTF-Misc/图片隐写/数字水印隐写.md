# 数字水印

数字水印目前由于在版权领域和产权鉴定十分流行，故在CTF领域也非常常见。并且由于数字水印的特征会随着水印方式和算法的差异性而不同，故这里只介绍常见的数字水印和处理方式。

## 盲水印

盲水印分为不同的种类，其中分为两大题型，分别是给出原图和水印图，要求分离信息，还有一种就是只给出水印图，要求分离信息。这里将两大类型各举一个经典工具，并加以说明。

需要注意的是，盲水印这类加密方式，是基本不可能通过简单查看颜色通道就能发现水印信息的。能直接看到水印信息的，那是LSB。

### 给出了原图和水印图

 chishaxie/BlindWaterMark：https://github.com/chishaxie/BlindWaterMark

并不是说所有这类水印题都是这个脚本出的，但是绝大可能都是用了这个脚本。毕竟经典又好用。。

例题：[双目失明，身残志坚](https://buuoj.cn/match/matches/36/challenges#%E5%8F%8C%E7%9B%AE%E5%A4%B1%E6%98%8E%EF%BC%8C%E8%BA%AB%E6%AE%8B%E5%BF%97%E5%9D%9A)

这题就是明显的盲水印了，用`stegsolve`对两张图片进行交叉比对。不能发现有明显信息，但是存在人为的信息痕迹。

![image-20220119230336120](../CTF-images/image-20220119230336120.png)

![image-20220119230349821](../CTF-images/image-20220119230349821.png)

于是想到用脚本来解密：

```shell
$python .\bwmforpy3.py decode .\original.png .\blind.png out.png
# image<.\original.png> + image(encoded)<.\blind.png> -> watermark<out.png>
```

得到：

![image-20220119230705952](../CTF-images/image-20220119230705952.png)

根据题意，查阅资料后可以得知，这个就是一张盲文信息，对照后即可解出flag。

## 两图片异或比较不同像素

